<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Workout Tracker</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="container">
    <h2 class="mb-3 text-center">Workout Tracker ðŸ’ª</h2>
    
    <div class="card sticky-top">
      <div class="card-body p-3">
        <!-- Day Selector -->
        <div class="mb-3">
          <label for="daySelect" class="form-label">Select Workout Day</label>
          <select id="daySelect" class="form-select">
            <option value="">-- Choose a Day --</option>
            <!-- Days will be populated from JS -->
          </select>
        </div>
        
        <div class="d-flex justify-content-between">
          <button id="saveBtn" class="btn btn-success">
            <i class="bi bi-save"></i> Save Workout
          </button>
          <div class="btn-group">
            <button id="viewLogsBtn" class="btn btn-primary">
              <i class="bi bi-journal-text"></i> View Logs
            </button>
            <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
              <span class="visually-hidden">Toggle Dropdown</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end">
              <li><a class="dropdown-item" href="#" id="exportBtn"><i class="bi bi-download"></i> Export Data</a></li>
              <li><a class="dropdown-item" href="#" id="importBtn"><i class="bi bi-upload"></i> Import Data</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item text-danger" href="#" id="clearBtn"><i class="bi bi-trash"></i> Clear All Data</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Exercise List -->
    <div id="exerciseList" class="mt-3"></div>

    <!-- Logs -->
    <div id="logsSection" class="mt-4" style="display: none;">
      <h4 class="mb-3">Workout History</h4>
      <div id="logList" class="accordion"></div>
    </div>
    
    <!-- Import File Input (Hidden) -->
    <input type="file" id="importFile" accept=".json" style="display: none;">
  </div>

  <!-- Bootstrap JS Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Workout Routines -->
  <script src="js/routines.js"></script>
  
  <!-- Main Application JS -->
  <script src="js/app.js"></script>
</body>
</html>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Workout routine data
    const routine = {
      "Push A": [
        { name: "Incline Dumbbell Bench Press", sets: 4 },
        { name: "Seated Chest Press", sets: 3 },
        { name: "Overhead Shoulder Press", sets: 3 },
        { name: "Chest Fly", sets: 3 },
        { name: "Lateral Raises", sets: 3 },
        { name: "Overhead Tricep Extension", sets: 3 },
        { name: "Tricep Pushdowns", sets: 3 }
      ],
      "Pull A": [
        { name: "Lat Pulldown / Chin-Ups", sets: 4 },
        { name: "Seated Cable Row / Barbell Row", sets: 3 },
        { name: "Hyperextensions", sets: 3 },
        { name: "Shrugs", sets: 3 },
        { name: "Incline DB / Bayesian Curls", sets: 4 },
        { name: "Preacher / Spider Curls", sets: 3 },
        { name: "Wrist Curls + Dead Hangs", sets: 3 }
      ],
      "Legs A": [
        { name: "Barbell Squat", sets: 4 },
        { name: "Hip Thrusts", sets: 3 },
        { name: "Leg Extensions", sets: 3 },
        { name: "Standing Calf Raises", sets: 4 },
        { name: "Weighted Crunches", sets: 3 }
      ],
      "Push B": [
        { name: "Dumbbell Shoulder Press", sets: 3 },
        { name: "Flat Bench Press", sets: 3 },
        { name: "Lateral Raises", sets: 3 },
        { name: "Incline Dumbbell Fly", sets: 3 },
        { name: "Front Raise", sets: 3 },
        { name: "Skull Crushers", sets: 3 },
        { name: "Weighted Dips / Kickbacks", sets: 3 }
      ],
      "Pull B": [
        { name: "Barbell Row (overhand)", sets: 4 },
        { name: "Pull-Ups (neutral/close)", sets: 3 },
        { name: "Rear Delt Fly / Face Pulls", sets: 3 },
        { name: "Single-Arm DB Row", sets: 3 },
        { name: "Standing Cable Curl", sets: 4 },
        { name: "Hammer / Reverse Curls", sets: 3 },
        { name: "Wrist Curls + Dead Hangs", sets: 3 }
      ],
      "Legs B": [
        { name: "Leg Press", sets: 4 },
        { name: "Romanian Deadlift", sets: 4 },
        { name: "Dumbbell Lunges", sets: 3 },
        { name: "Hamstring Curls", sets: 3 },
        { name: "Seated Calf Raises", sets: 4 },
        { name: "Weighted Crunches", sets: 3 }
      ]
    };

    // DOM elements
    const daySelect = document.getElementById("daySelect");
    const exerciseList = document.getElementById("exerciseList");
    const saveBtn = document.getElementById("saveBtn");
    const viewLogsBtn = document.getElementById("viewLogsBtn");
    const logList = document.getElementById("logList");
    const logsSection = document.getElementById("logsSection");
    const exportBtn = document.getElementById("exportBtn");
    const importBtn = document.getElementById("importBtn");
    const importFile = document.getElementById("importFile");
    const clearBtn = document.getElementById("clearBtn");

    // Event listeners
    daySelect.addEventListener("change", loadExercises);
    saveBtn.addEventListener("click", saveWorkout);
    viewLogsBtn.addEventListener("click", toggleLogs);
    exportBtn.addEventListener("click", exportData);
    importBtn.addEventListener("click", () => importFile.click());
    importFile.addEventListener("change", importData);
    clearBtn.addEventListener("click", clearData);

    // Load exercises based on selected day
    function loadExercises() {
      const day = daySelect.value;
      exerciseList.innerHTML = "";
      if (!day) return;

      // Hide logs view when selecting a new workout
      logsSection.style.display = "none";

      // Create exercise cards
      routine[day].forEach((ex, index) => {
        const card = document.createElement("div");
        card.classList.add("card", "mb-3");
        card.innerHTML = `
          <div class="card-header py-2">
            <strong>${ex.name}</strong>
          </div>
          <div class="card-body p-3">
            <div class="exercise-sets" data-exercise="${index}">
              ${generateSetInputs(ex.sets, index)}
            </div>
          </div>
        `;
        exerciseList.appendChild(card);
      });
    }

    // Generate input fields for each set
    function generateSetInputs(numSets, exerciseIndex) {
      let inputs = '';
      for (let i = 1; i <= numSets; i++) {
        inputs += `
          <div class="set-input">
            <span>Set ${i}:</span>
            <input type="number" class="form-control weight" placeholder="kg" min="0" step="0.5">
            <input type="number" class="form-control reps" placeholder="reps" min="0">
          </div>
        `;
      }
      return inputs;
    }

    // Save workout data
    function saveWorkout() {
      const day = daySelect.value;
      if (!day) return alert("Please select a workout day!");

      let hasData = false;

      const logEntry = {
        id: Date.now(),
        date: new Date().toISOString(),
        displayDate: new Date().toLocaleDateString(),
        day,
        exercises: []
      };

      // Collect exercise data
      routine[day].forEach((ex, index) => {
        const exerciseData = {
          name: ex.name,
          sets: []
        };
        
        const setElements = document.querySelectorAll(`[data-exercise="${index}"] .set-input`);
        setElements.forEach((setElement, setIndex) => {
          const weight = setElement.querySelector(".weight").value;
          const reps = setElement.querySelector(".reps").value;
          
          // Save set data even if it's empty (weight and reps will be 0)
          exerciseData.sets.push({
            setNum: setIndex + 1,
            weight: weight ? parseFloat(weight) : 0,
            reps: reps ? parseInt(reps) : 0
          });
          
          // Check if we have any actual data
          if (weight || reps) {
            hasData = true;
          }
        });
        
        logEntry.exercises.push(exerciseData);
      });

      // Warn if no data was entered
      if (!hasData) {
        if (!confirm("No weight or rep data was entered. Save anyway?")) {
          return;
        }
      }

      // Save to localStorage
      const logs = JSON.parse(localStorage.getItem("workoutLogs") || "[]");
      logs.unshift(logEntry); // Add to the beginning for reverse chronological order
      localStorage.setItem("workoutLogs", JSON.stringify(logs));

      // Show success message with more details
      alert(`Workout saved successfully!\n\nDay: ${day}\nDate: ${new Date().toLocaleDateString()}\n\nYou can view your saved workouts by clicking the "View Logs" button.`);
      
      // Reset the form
      exerciseList.innerHTML = "";
      daySelect.value = "";
      
      // Open the logs to show the saved workout
      logsSection.style.display = "block";
      displayLogs();
    }

    // Toggle logs view
    function toggleLogs() {
      if (logsSection.style.display === "none") {
        displayLogs();
        logsSection.style.display = "block";
        exerciseList.innerHTML = "";
        daySelect.value = "";
      } else {
        logsSection.style.display = "none";
      }
    }

    // Display workout logs
    function displayLogs() {
      logList.innerHTML = "";
      const logs = JSON.parse(localStorage.getItem("workoutLogs") || "[]");
      
      if (logs.length === 0) {
        logList.innerHTML = '<div class="alert alert-info">No workout logs found.</div>';
        return;
      }

      logs.forEach((log, index) => {
        const formattedDate = new Date(log.date).toLocaleDateString('en-US', {
          weekday: 'short',
          year: 'numeric', 
          month: 'short', 
          day: 'numeric'
        });
        
        const accordionItem = document.createElement('div');
        accordionItem.classList.add('accordion-item');
        accordionItem.innerHTML = `
          <h2 class="accordion-header" id="heading-${log.id}">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapse-${log.id}" aria-expanded="false" aria-controls="collapse-${log.id}">
              <div class="d-flex justify-content-between w-100">
                <span>${log.day}</span>
                <span class="workout-date">${formattedDate}</span>
              </div>
            </button>
          </h2>
          <div id="collapse-${log.id}" class="accordion-collapse collapse" 
               aria-labelledby="heading-${log.id}" data-bs-parent="#logList">
            <div class="accordion-body p-3">
              ${generateLogDetails(log)}
            </div>
          </div>
        `;
        
        logList.appendChild(accordionItem);
      });
    }

    // Generate detailed view of workout log
    function generateLogDetails(log) {
      let details = '';
      
      log.exercises.forEach(exercise => {
        if (exercise.sets.length > 0) {
          details += `<div class="mb-3">
            <div class="exercise-title">${exercise.name}</div>
            <div class="sets-list">`;
          
          exercise.sets.forEach(set => {
            details += `<div class="small">Set ${set.setNum}: ${set.weight} kg Ã— ${set.reps} reps</div>`;
          });
          
          details += `</div></div>`;
        }
      });
      
      return details || '<div class="text-muted">No exercise data recorded</div>';
    }

    // Export data as JSON file
    function exportData() {
      const logs = JSON.parse(localStorage.getItem("workoutLogs") || "[]");
      if (logs.length === 0) {
        return alert("No workout data to export!");
      }
      
      const dataStr = JSON.stringify(logs, null, 2);
      const dataUri = "data:application/json;charset=utf-8," + encodeURIComponent(dataStr);
      
      const exportFileName = `workout-logs-${new Date().toISOString().slice(0,10)}.json`;
      
      const linkElement = document.createElement("a");
      linkElement.setAttribute("href", dataUri);
      linkElement.setAttribute("download", exportFileName);
      linkElement.click();
    }

    // Import data from JSON file
    function importData(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const importedData = JSON.parse(e.target.result);
          
          if (!Array.isArray(importedData)) {
            throw new Error("Invalid data format");
          }
          
          if (confirm("Import will replace all existing data. Continue?")) {
            localStorage.setItem("workoutLogs", JSON.stringify(importedData));
            alert("Data imported successfully!");
            
            // Refresh logs if they're currently being displayed
            if (logsSection.style.display !== "none") {
              displayLogs();
            }
          }
        } catch (error) {
          alert("Error importing data: " + error.message);
        }
        
        // Reset file input
        importFile.value = "";
      };
      reader.readAsText(file);
    }

    // Clear all data
    function clearData() {
      if (confirm("Are you sure you want to delete all workout data? This cannot be undone!")) {
        localStorage.removeItem("workoutLogs");
        alert("All workout data has been cleared!");
        
        // Refresh logs if they're currently being displayed
        if (logsSection.style.display !== "none") {
          displayLogs();
        }
      }
    }
  </script>
</body>
</html>
